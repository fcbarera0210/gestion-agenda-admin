<div class="fixed inset-0 z-40 bg-black bg-opacity-50" (click)="cancel()"></div>

<div class="fixed inset-0 z-50 flex items-start md:items-center justify-center p-4 overflow-y-auto">
  <div class="w-full max-w-lg p-8 bg-white rounded-2xl shadow-lg space-y-6">
    <h2 class="text-2xl font-bold text-gray-800">Detalles de Cita</h2>

    <div class="space-y-4">
      <div>
        <h3 class="text-lg font-semibold text-gray-700">Cliente</h3>
        <p class="text-sm text-gray-600"><strong>Nombre:</strong> {{ client?.name }}</p>
        <p class="text-sm text-gray-600"><strong>Email:</strong> {{ client?.email }}</p>
        <p class="text-sm text-gray-600"><strong>Tel√©fono:</strong> {{ client?.phone }}</p>
        <p *ngIf="client?.notes" class="text-sm text-gray-600"><strong>Notas:</strong> {{ client?.notes }}</p>
      </div>

      <div>
        <h3 class="text-lg font-semibold text-gray-700">Cita</h3>
        <p class="text-sm text-gray-600"><strong>Servicio:</strong> {{ serviceName }}</p>
        <p class="text-sm text-gray-600"><strong>Fecha:</strong> {{ appointment.start.toDate() | date:'fullDate' }}</p>
        <p class="text-sm text-gray-600"><strong>Hora:</strong> {{ appointment.start.toDate() | date:'shortTime' }}</p>
        <p class="text-sm text-gray-600"><strong>Tipo:</strong> {{ appointment.type === 'online' ? 'Online' : 'Presencial' }}</p>
      </div>

      <form [formGroup]="form" (ngSubmit)="save()" class="space-y-4">
        <div>
          <label class="text-sm font-medium text-gray-700">Estado</label>
          <div class="flex mt-1 space-x-2">
            <button type="button" class="flex-1 px-4 py-2 rounded-lg border"
                    [ngClass]="form.get('status')?.value === 'confirmed' ? 'bg-blue-500 text-white border-blue-500' : 'bg-blue-50 text-blue-700 border-blue-200'"
                    (click)="setStatus('confirmed')">Confirmada</button>
            <button type="button" class="flex-1 px-4 py-2 rounded-lg border"
                    [ngClass]="form.get('status')?.value === 'pending' ? 'bg-yellow-500 text-white border-yellow-500' : 'bg-yellow-50 text-yellow-700 border-yellow-200'"
                    (click)="setStatus('pending')">Pendiente</button>
            <button type="button" class="flex-1 px-4 py-2 rounded-lg border"
                    [ngClass]="form.get('status')?.value === 'cancelled' ? 'bg-red-500 text-white border-red-500' : 'bg-red-50 text-red-700 border-red-200'"
                    (click)="setStatus('cancelled')">Cancelada</button>
          </div>
        </div>

        <div>
          <label for="notes" class="text-sm font-medium text-gray-700">Nota</label>
          <textarea id="notes" formControlName="notes" rows="3"
                    class="w-full px-4 py-3 mt-1 text-gray-700 bg-gray-100 border rounded-lg"></textarea>
        </div>

        <div class="flex flex-col md:flex-row md:justify-end md:space-x-4 space-y-4 md:space-y-0 pt-4 border-t">
          <button type="button" (click)="cancel()" class="w-full px-4 py-2 font-semibold text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">Cancelar</button>
          <button type="submit" class="w-full md:w-32 px-4 py-2 font-semibold text-white rounded-lg bg-primary hover:bg-opacity-90">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>
